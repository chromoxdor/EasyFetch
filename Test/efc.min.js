var currentDivId,menu;window.efc=!0,window.configMode=!1;var saveButton=null,resetButton=null,toggleButton=null;const pointerEventsStyle=document.createElement("style");var contextIsAlready=!1;let tempName="";var mOpen,nOpen,selectionDataOld,interactionHandled=!1;const efcVersion="20250620/2",expected="20250620/2";function addContext(){/(android)/i.test(navigator.userAgent)||document.addEventListener("contextmenu",handleRightClick,!0)}function handleRightClick(e){e.preventDefault(),removeHighlighting();let t,n=e.target.closest('div[id^="efc"]');if(addPointerEvents(),null===n){t=e.target;const o=Array.from(t.children);o.length>0&&o.forEach((o=>{if(o.id.includes("efc")){const o=document.elementFromPoint(e.clientX,e.clientY);o&&(n=o,n.classList.contains("sensors")&&(n=o?.parentElement),t.id.startsWith("sliderList")&&(n=o?.parentElement?.parentElement))}}))}if(n&&(n.id.startsWith("efc")||"unitId"===n.id)){const t=n.querySelector("span");isittime=!1,updateSaveButton("initial"),currentDivId=n.id,rebuildContextMenu(n.id,n.className,t),e.detail.clientX?(xCoord=e.detail.clientX,yCoord=e.detail.clientY):(xCoord=e.clientX,yCoord=e.clientY),menu.style.display="block";const o=document.getElementById("custom-menu");if(o&&o.offsetWidth>0){const e=o.offsetWidth,t=o.offsetHeight,n=window.scrollX,i=window.scrollY;let a=xCoord+n+5;a+e>window.innerWidth+n&&(a=window.innerWidth+n-e-10),a=Math.max(10,a);let l=yCoord+i;const r=i+40,d=i+window.innerHeight-t-50;l=Math.min(Math.max(l,r),d),o.style.position="absolute",o.style.left=`${a}px`,o.style.top=`${l}px`}}else(t.id.startsWith("allList")||t.id.startsWith("container"))&&updateSaveButton("initial")}function highlightMatchingDivs(e,t){let n=e.substring(0,e.lastIndexOf(","));if(!n)return;document.querySelectorAll(`div[id*="${n.split("=")[1]}"]`).forEach((e=>{e.style.outline="2px solid #ffcc00"}));let o=document.querySelectorAll(`[id="${e}"]`);o.length>0&&o.forEach((e=>{!t.includes("bigNumWrap")&&!t.includes("bigSingles")||contextIsAlready?e.style.outline="2px solid red":e.parentElement&&(e.parentElement.style.setProperty("transition","none","important"),e.parentElement.style.outline="2px solid red")}))}function removeHighlighting(){const e=document.getElementById("allList");e.style.setProperty("transition-property","none");e.querySelectorAll("div").forEach((e=>e.style.outline="")),setTimeout((()=>{e.style.removeProperty("transition")}),50)}function parseDivId(e){if(e.startsWith("efc")){let[t,n]=e.split("="),o=n.match(/(\d+),(\d+),(\d+)([A-Z]?)$/);return o?{deviceName:t.split(":")[1],deviceType:parseInt(o[1]),deviceIndex:o[2],valueIndex:o[4]||o[3]}:null}return null}function rebuildContextMenu(e,t,n){let o=parseDivId(currentDivId);if(!o)return;let{deviceName:i,deviceType:a,deviceIndex:l,valueIndex:r}=o;const d=[43,1,81].includes(a);let s=selectionData[l]?selectionData[l][r]:{},c=selectionData[l]?.A?.val;menu.innerHTML="";let u=document.createElement("select");u.id="menu-main-select",u.dataset.key="val";let p="";"bigVal"===c||"bigVS"===s?.val?tempName!==i?(contextIsAlready=!1,tempName=i):contextIsAlready=!0:(contextIsAlready=!1,tempName=""),highlightMatchingDivs(e,t),"A"===r&&1!==a||"bigVal"===c&&!contextIsAlready?(p='\n            <option value="none">None</option>\n            <option value="bigVal">big values</option>\n        ',a="A"):"bigSingle"!==i||contextIsAlready?33===a?(p='\n            <option value="none">None</option>\n            <option value="dButtons">button</option>\n            <option value="pButtons">push button</option>\n            <option value="vInput">num input</option>\n            <option value="vSlider">slider</option>\n            <option value="nvSlider">no value Slider</option>\n            <option value="tSlider">time slider</option>\n            <option value="thSlider">thermo slider</option>\n            <option value="nPix">neopixel slider</option>\n        ',(checkBigSinglesLength()<4||4==checkBigSinglesLength()&&"bigVS"===s?.val)&&(p+='<option value="bigVS">big value</option>')):(p='\n            <option value="none">None</option>\n            <option value="vSlider">slider</option>\n        ',(checkBigSinglesLength()<4||4==checkBigSinglesLength()&&"bigVS"===s?.val)&&(p+='<option value="bigVS">big value</option>')):a="S",u.innerHTML=p,(d||contextIsAlready&&"bigVal"===c||"S"===a)&&(u.style.display="none"),menu.appendChild(u),menu.appendChild(document.createElement("br")),u.addEventListener("change",(e=>{updateMenuFields(a,e.target.value,i,l),saveSelections(!1)}));let m=u.dataset.key;"bigVal"===c&&"A"===a&&(s=selectionData[l]?.A),void 0!==s&&void 0!==s[m]&&(u.value=s[m],d&&(u.value="")),updateMenuFields(a,u.value,i,l,r,d,t,n)}function updateMenuFields(e,t,n,o,i,a,l,r){let d=document.getElementById("dynamic-fields");d&&menu.removeChild(d),d=document.createElement("div"),d.id="dynamic-fields",d.style.display="grid","S"===e?addColorPicker(d,"color: ","SBC"):("A"===e&&["dButtons","pButtons"].includes(t)&&addCheckbox(d," no input","noI"),"C"===e&&addNumberInput(d," columns","cols"),["vSlider","nvSlider","thSlider"].includes(t)&&addTextInput(d,"range: ","range",t),["dButtons","vSlider"].includes(t)&&33===e&&addCheckbox(d," no input","noI"),["tSlider"].includes(t)&&33===e&&(addTextInput(d,"taskname: ","timeName"),addDropdown(d,"day"),addDropdown(d,"fields")),(!["thSlider","tSlider","dButtons","pButtons","bigVal"].includes(t)&&"A"!==e&&1!==e||contextIsAlready&&"A"!==e)&&(r?.title||addTextInput(d,"UoM: ","unit"),addCheckbox(d," hide name","noV")),["dButtons"].includes(t)&&33===e&&addTextInput(d,"sendTo: ","sendTo"),"A"!==e||a||(addCheckbox(d," chart","chart"),selectionData[o]?.A?.chart&&addCheckbox(d," always Y","Y"),l?.includes("chart")?addColorPicker(d,"color: ","color",!0):addColorPicker(d,"color: ","color")),("A"===e&&!["bigVal"].includes(t)||a||contextIsAlready||"bigVS"===t||"vSlider"===t||33===e&&!["none"].includes(t))&&addNumberInput(d,"order: ","order"),"none"===t&&!hasNonEmptyValues(selectionData,o)||contextIsAlready||addResetButton(d,o,n),addCheckbox(d," hide entry","hide")),menu.appendChild(d);let s=parseDivId(currentDivId);if(s){let t,{deviceIndex:n,valueIndex:o}=s;"A"===e&&(o="A"),t="S"!==e?selectionData[n]?selectionData[n][o]:{}:selectionData?.S,d.querySelectorAll("input, select, button").forEach((e=>{let n=e.dataset.key;void 0!==t&&void 0!==t[n]&&("checkbox"===e.type?e.checked=1===t[n]:("number"===e.type||e.tagName.toLowerCase(),e.value=t[n]))}))}d.addEventListener("input",(()=>saveSelections(!1)))}function addTextInput(e,t,n,o){let i=document.createElement("label");i.innerText=t;let a=document.createElement("input");a.type="text","unit"===n&&(a.maxLength=6,a.style.width="6ch"),"range"===n&&(["vSlider","nvSlider"].includes(o)?a.placeholder="0,1024,1":["thSlider"].includes(o)&&(a.placeholder="5,35,1"),a.addEventListener("input",(e=>{a.value=a.value.replace(/[^0-9.,-]/g,"")})),a.addEventListener("blur",(()=>{if(""===a.value.trim())return;/^-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?$/.test(a.value)||(alert("Invalid format! Please enter three values separated by two commas (e.g., 0,1024,0.5)"),a.value="")}))),"sendTo"===n&&(a.placeholder="nodeNR(,GPIO)",a.style.width="15ch",a.addEventListener("input",(()=>{a.value=a.value.replace(/[^0-9,]/g,"")})),a.addEventListener("blur",(()=>{if(""===a.value.trim())return;/^\d+$|^\d+,?\d+$/.test(a.value)||(alert("Invalid format! Please enter either a nodenumber (e.g., 12) or a nodenumber + comma + the GPIO to toggle (e.g., 2,12)."),a.value="")}))),a.dataset.key=n,e.appendChild(i),e.appendChild(a)}function addNumberInput(e,t,n){let o=document.createElement("label");o.innerText=t,o.style.marginRight="5px";let i=document.createElement("input");if(i.type="number",i.dataset.key=n,i.style.width="4ch",i.style.textAlign="center","order"===n){i.min="0",i.max="255",i.step="1",i.value="0";let t=document.createElement("div");t.style.display="inline-flex",t.style.alignItems="center",t.style.gap="5px";let n=document.createElement("button");n.innerText="âˆ’",n.type="button",n.style.width="25px";let l=document.createElement("button");function a(e){let t=parseInt(i.value)+e;i.value=t,saveSelections(!1)}l.innerText="+",l.type="button",l.style.width="25px",l.addEventListener("click",(()=>a(1))),n.addEventListener("click",(()=>a(-1))),t.appendChild(n),t.appendChild(i),t.appendChild(l),e.appendChild(o),e.appendChild(t)}else e.appendChild(o),e.appendChild(i)}function addCheckbox(e,t,n){let o=document.createElement("label"),i=document.createElement("input");i.type="checkbox",i.dataset.key=n,o.style.padding="5px 0",o.appendChild(i),o.appendChild(document.createTextNode(t)),e.appendChild(o)}function addDropdown(e,t){const n={day:{label:"Day:",options:["All","Mon","Tue","Wed","Thu","Fri","Sat","Sun","Wrk","Wkd"]},fields:{label:"Fields:",options:["1-2","3-4","5-6","7-8"]}};if(!n[t])return;const{label:o,options:i}=n[t],a=document.createElement("div");a.style.padding="5px 0";const l=document.createElement("span");l.textContent=o,l.style.marginRight="5px";const r=document.createElement("select");r.dataset.key=t,r.style.padding="2px 5px",i.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,r.appendChild(t)})),a.appendChild(l),a.appendChild(r),e.appendChild(a)}function addColorPicker(e,t,n,o){let i=document.createElement("label");i.innerText=t;let a=document.createElement("input");a.type="color",a.dataset.key=n,o&&(i.style.display="none",a.style.display="none"),e.appendChild(i),e.appendChild(a)}function addResetButton(e,t,n){let o=document.createElement("button");e.appendChild(document.createElement("br")),o.innerText=`reset ${n}`,o.style.backgroundColor="#7d1414",o.style.color="white",o.style.padding="2px",o.addEventListener("click",(()=>deleteDevice(t))),e.appendChild(o)}function hasNonEmptyValues(e,t){return!(!e[t]||"object"!=typeof e[t])&&Object.values(e[t]).some((e=>Object.values(e).some((e=>0!==e&&""!==e&&void 0!==e))))}function deleteDevice(e){delete selectionData[e],saveSelections(!0),closeContextMenu()}function saveSelections(e){let t=parseDivId(currentDivId);if(!t)return;let{deviceName:n,deviceIndex:o,valueIndex:i}=t;selectionData[o]||(selectionData[o]={}),selectionData[o][i]||(selectionData[o][i]={});let a=document.getElementById("dynamic-fields"),l={};selectionData.unit=unitName,selectionData.nr=unitNr;let r=document.getElementById("menu-main-select");if(r){let e=r.dataset.key;e&&(l[e]=r.value)}a&&a.querySelectorAll("input, select").forEach((e=>{let t=e.dataset.key;"hide"===t&&(html2=""),"checkbox"===e.type?l[t]=e.checked?1:0:"number"===e.type?l[t]=parseFloat(e.value)||0:"text"===e.type?l[t]=e.value:"color"===t&&"#000000"===e.value?l[t]="":l[t]=e.value})),"bigVal"!==selectionData[o]?.A?.val||contextIsAlready||(i="A"),e||("bigSingle"!==n||contextIsAlready?selectionData[o][i]=l:selectionData.S=l),removeEmptyKeys(selectionData),updateSaveButton(),extraConfig()}function keepOnlyA(e){if(e&&"object"==typeof e)for(const t in e)"A"!==t&&delete e[t]}function updateSaveButton(e){"initial"!==e||selectionDataOld||(closeNav(),selectionDataOld=JSON.stringify(selectionData));const t="hide"===e,n={true:["&#9776;&#xFE0E;","&#8962;&#xFE0E;"],false:["&#9881;&#xFE0E;","&times;&#xFE0E;"]};nOpen&&(nOpen.innerHTML=n[t][0]),mOpen&&(mOpen.innerHTML=n[t][1]),saveButton.style.display=!t&&selectionDataOld&&selectionDataOld!==JSON.stringify(selectionData)?"block":"none",resetButton.style.display=t?"none":"block",toggleButton.style.display=!t&&hasHiddenProperty(selectionData)?"block":"none",t&&closeContextMenu(),window.configMode=!t}function createSaveButton(){(saveButton=document.createElement("button")).innerText="Save Settings",saveButton.style.position="fixed",saveButton.style.top="10px",saveButton.style.left="calc(50% - 40px)",saveButton.style.transform="translateX(-120px)",saveButton.style.padding="10px 15px",saveButton.style.background="#28a745",saveButton.style.color="white",saveButton.style.border="none",saveButton.style.borderRadius="5px",saveButton.style.cursor="pointer",saveButton.style.zIndex="3",saveButton.style.display="none",saveButton.addEventListener("click",saveToFile),document.body.appendChild(saveButton),(resetButton=document.createElement("button")).innerText="Reset File",resetButton.style.position="fixed",resetButton.style.top="10px",resetButton.style.left="calc(50% + 30px)",resetButton.style.transform="translateX(-50%)",resetButton.style.padding="10px 15px",resetButton.style.background="red",resetButton.style.color="white",resetButton.style.border="none",resetButton.style.borderRadius="5px",resetButton.style.cursor="pointer",resetButton.style.zIndex="3",resetButton.style.display="none",resetButton.addEventListener("click",(()=>saveToFile("del"))),document.body.appendChild(resetButton),(toggleButton=document.createElement("button")).innerText=hiddenOverride?"Hide":"Show",toggleButton.style.position="fixed",toggleButton.style.top="10px",toggleButton.style.left="calc(50% + 128px)",toggleButton.style.transform="translateX(-50%)",toggleButton.style.padding="10px 15px",toggleButton.style.background="#007bff",toggleButton.style.color="white",toggleButton.style.border="none",toggleButton.style.borderRadius="5px",toggleButton.style.cursor="pointer",toggleButton.style.zIndex="3",toggleButton.style.display="none",document.body.appendChild(toggleButton),toggleButton.addEventListener("click",(()=>{hiddenOverride=!hiddenOverride,toggleButton.innerText=hiddenOverride?"Hide":"Show"}))}function saveToFile(e){"use strict";updateJsonArray(selectionData);let t=JSON.stringify(selectionData,null,2);if("del"===e){const e=`Are you sure you want to delete ALL the settings of ${selectionData.unit}?`;if(!confirm(e))return;t="{}",selectionData.unit&&(efcArray=efcArray.filter((e=>e.unit!==selectionData.unit)))}let n=JSON.stringify(efcArray,null,2);loadScript("https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js",(function(){const e=pako.gzip(t),o=new File([e],"efc.json.gz",{type:"application/gzip"}),i=new FormData;i.append("file",o);const a=`${baseUrl}/upload`;if(unitNr===unitNr1&&isMain||fetchFile(a,i),isMain){const e=pako.gzip(n),t=new File([e],"main_efc.json.gz",{type:"application/gzip"}),o=new FormData;o.append("file",t),fetchFile("/upload",o)}})),exitConfig()}function fetchFile(e,t){const n=new AbortController,o=setTimeout((()=>n.abort()),5500);fetch(e,{method:"POST",body:t,mode:"cors",signal:n.signal}).then((e=>{if(clearTimeout(o),!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);runonce2=!0})).catch((e=>{clearTimeout(o)}))}function saveUrlToServer(e,t){fetch(e).then((e=>{if(!e.ok)throw new Error(`Failed to fetch: ${e.statusText}`);return e.blob()})).then((e=>{const n=new File([e],t,{type:e.type}),o=new FormData;o.append("file",n),fetchFile("/upload",o),alert("Upgrade Successful"),document.cookie="efcVersion=; path=/; max-age=0",location.reload()})).catch((e=>{}))}function createMenu(){if(nOpen=document.getElementById("nOpen"),mOpen=document.getElementById("mOpen"),document.getElementById("areaChart")?.addEventListener("resize",updateYAxisVisibility),mOpen.onclick=function(e){configMode?(e.preventDefault(),e.stopPropagation(),exitConfig()):(splitOn(),topF())},nOpen.addEventListener("long-press",(()=>{"none"===saveButton.style.display&&selectionData.unit?(updateSaveButton("initial"),setLongPressDelay(200),"ontouchstart"in window&&document.addEventListener("long-press",handleRightClick,!0)):exitConfig()})),"ontouchstart"in window){let e=0;const t=200;document.addEventListener("touchstart",(t=>{e=Date.now()}),{passive:!0}),document.addEventListener("touchend",(n=>{Date.now()-e<t&&handleInteraction(n)}),{passive:!1})}else document.addEventListener("click",handleInteraction);(menu=document.createElement("div")).id="custom-menu",menu.style.position="absolute",menu.style.display="none",menu.style.background="#3a3a3ad9",menu.style.border="1px solid #ccc",menu.style.padding="10px",menu.style.color="white",document.body.appendChild(menu),createSaveButton()}function handleInteraction(e){menu.contains(e.target)||e.target.className.includes("vInputs")||!configMode||((e.target===container&&"none"===menu.style.display||mOpen.contains(e.target))&&(mOpen.contains(e.target)&&configMode&&(e.preventDefault(),e.stopPropagation()),exitConfig()),closeContextMenu())}function closeContextMenu(){menu.style.display="none",tempName="",removeHighlighting(),removePointerEvents(),updateYAxisVisibility(),isittime=!0,newFJ()}function handleData(e){document.body.innerHTML+=`<p>Received data: ${JSON.stringify(e)}</p>`}function updateJsonArray(e){let t=efcArray.findIndex((t=>t.unit===e.unit));-1!==t?efcArray[t]=e:efcArray.push(e)}function removeEmptyKeys(e){for(let t in e)if(e.hasOwnProperty(t)){const n=e[t];"object"==typeof n&&null!==n?(removeEmptyKeys(n),0===Object.keys(n).length&&delete e[t]):""!==n&&null!=n||delete e[t]}}function loadScript(e,t){const n=document.createElement("script");n.src=e,n.type="text/javascript",n.onload=t,document.head.appendChild(n)}function addPointerEvents(){pointerEventsStyle.innerHTML="#container * { pointer-events: all !important; }",document.head.appendChild(pointerEventsStyle)}function removePointerEvents(){pointerEventsStyle&&pointerEventsStyle.remove()}function hasHiddenProperty(e){for(const t of Object.values(e))if("object"==typeof t&&null!==t&&(1===t.hide||hasHiddenProperty(t)))return!0;return!1}function checkBigSinglesLength(){return document.querySelectorAll(".bigSingles").length}function exitConfig(){closeNav(),selectionData={},selectionDataOld="",htmlold="",updateSaveButton("hide"),hiddenOverride=!1,setLongPressDelay(600),document.removeEventListener("long-press",handleRightClick,!0),runonce2=!0,setTimeout(newFJ,200)}function uploadJson(){const e=prompt("Paste your JSON here:");if(null!==e&&e.length>2){let t=e;e.startsWith("[")&&e.endsWith("]")&&(t=e.slice(1,-1));try{selectionData=JSON.parse(t),updateSaveButton()}catch(e){}}}function transferGzFile(e){loadScript("https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js",(()=>{fetch("/main_efc.json.gz").then((e=>{if(!e.ok)throw new Error(`Failed to fetch source file (${e.status})`);return e.arrayBuffer()})).then((t=>{const n=pako.gzip(t),o=new File([n],"main_efc.json.gz",{type:"application/gzip"}),i=new FormData;i.append("file",o),fetchFile(e,i)})).catch((e=>{}))}))}function extraConfig(){updateSaveButton();const e=document.getElementById("menueList");e.innerHTML="",e.innerHTML+=`\n        <div style="color: inherit;"><h2>Device specific settings<br> for ${unitName}:</h2></div>\n    `,e.innerHTML+=`\n    <div style="color: inherit;">\n        <label>Grid size:</label><br>\n        <div style="display: flex; gap: 5px; margin-top: 5px;">\n            ${[2,3,4].map((e=>`\n                <button style="padding: 4px 8px; border: 1px solid #ccc; border-radius: 4px; background:${e==bigLength?"green":"white"}"\n                        onclick="\n                            bigLength = ${e};\n                            htmlold = '';\n                            selectionData['G'] = bigLength;\n                            extraConfig();\n                        ">\n                    ${e}\n                </button>\n            `)).join("")}\n        </div>\n    </div>\n`,e.innerHTML+=`\n        <div  style="color: inherit;">\n            <label for="durationInput">Interval (sec):</label><br>\n            <input type="number" id="durationInput" class="vInputs" placeholder="${durationF/1e3}" min="1" max="60" step="1" style="width:80px; border: 1px solid #ccc; border-radius: 4px;">\n            <button onclick="const input = document.getElementById('durationInput');\n                             const v = input.value;\n                             if(v >= 1) {\n                                 durationF = +v * 1000;\n                                 selectionData['iV'] = durationF;\n                                 extraConfig();\n                             }">Submit</button>\n        </div>\n    `,JSON.stringify(selectionData).includes('"chart":1')&&(e.innerHTML+=`\n        <div  style="color: inherit;">\n            <label for="ChartIV">Chart Interval (sec):</label><br>\n            <input type="number" id="ChartIV" class="vInputs" placeholder="${nThX*(durationF/1e3)}" min="${durationF/1e3}" step="${durationF/1e3}" style="width:80px;border: 1px solid #ccc; border-radius: 4px;">\n            <button class="clickables" onclick="const v = document.getElementById('ChartIV').value;\n                if (v >= 1) {\n                    nThX = Math.ceil(v / (durationF / 1000));\n                    nTh = 0;\n                    selectionData['CiV'] = nThX;\n                    extraConfig();\n                }">\n                Submit\n            </button>\n        </div>\n    `),unitNr===unitNr1&&isMain&&(e.innerHTML+='\n            <div style="color: inherit;">\n                <label for="unitInput">Transfer settings to:</label><br>\n                <input type="number" id="unitInput" class="vInputs" min="1" max="255" placeholder="Unit #" style="width: 80px; border: 1px solid #ccc; border-radius: 4px;">\n                <button onclick="(() => {\n                const u = +document.getElementById(\'unitInput\').value;\n                const n = window.myJson2?.nodes?.find(n => n.nr == u && n.ip);\n                if (!n) return;\n                const uu = \'http://\' + n.ip + \'/upload\';\n                transferGzFile(uu);\n                })()">Transfer</button>\n            </div>\n            ',e.innerHTML+='\n        <br>\n        <button onclick="uploadJson()" \n               class="clickables" style="margin:10px 0; padding:5px 15px; background:green; color:white; border:none; border-radius:8px;">\n            Upload JSON\n        </button>\n        <br>\n        <span style="font-size:12px;">\n            (Integrate the config from a device<br>\n            by copying the contents of its<br> efc.json file\n            and pasting them into<br>  the upload field)\n        </span>\n        \n    '),e.innerHTML+='\n        <br><br><br><hr><br><br>\n        <div  style="color: inherit;"><h2>Gerneral Settings:</h2></div>\n        <span style="font-size:12px;color: red;">  No need to press Save<br> for these settings!</span></div>\n    ',["Snd","Two","Col"].forEach((t=>{const n=document.cookie.includes(`${t}=1`)?"checked":"";e.innerHTML+=`\n            <div>\n                <input type="checkbox" id="chk_${t}" ${n} onchange="mC('${t}')">\n                <label for="chk_${t}">${t}</label>\n            </div>\n        `}))}document.addEventListener("DOMContentLoaded",(()=>{const e=window.location.href.match(/\/([^\/?#]+\.html?.gz)/i)?.[1]||"index.htm.gz",t=document.getElementById("dateV")?.textContent.trim();if(!t)return;document.getElementById("dateV").innerHTML=`${t} (efc:20250620/2)`;const n=document.cookie.match(/efcVersion=([^;]+)/)?.[1];if(n===expected)return;const[o,i]=expected.split("/"),[a,l]=t.split("/"),r=parseInt(i.match(/\d+/)?.[0]||"0"),d=parseInt(l.match(/\d+/)?.[0]||"0");if(!r||!d)return alert("Invalid build number format");if(a<o||a===o&&d<r){const n="https://raw.githubusercontent.com/chromoxdor/EasyFetch/main/fetch.html.gz";confirm(`Your version of EasyFetch (${t}) is outdated.\nPlease update your ${e} to: 20250620/2 \nClick ok to install the latest version?\n\nIf this message appears again shortly after pressing "OK",\nabort, wait a while, then try again!!!`)?saveUrlToServer(n,e):document.cookie="efcVersion=20250620/2; path=/; max-age=86400"}}));var colorArray,chartInstances={};function getColorScheme(){const[,e]=getComputedStyle(document.body).backgroundColor.match(/\d+/g);return"0"===e?["rgba(34, 165, 89, 0.5)","rgba(34, 36, 165, 0.5)","rgba(255, 99, 133, 0.5)","rgba(115, 46, 133, 0.5)"]:["rgba(71, 227, 39, 0.6)","rgba(71, 209, 255, 0.6)","rgba(255, 75, 102, 0.6)","rgba(255, 78, 255, 0.6)"]}function makeChart(){checkColumns(),loadScript("https://cdn.jsdelivr.net/npm/chart.js",(function(){cD&&(colorArray=getColorScheme(),cD.forEach((e=>{if(!e.chart)return;let t=e.chart.data,n=`${e.device}chart`,o=document.getElementById(n);if(o)if(t.datasets.forEach(((e,t)=>{const n=colorArray[t%colorArray.length];e.backgroundColor=n,e.borderColor=n,e.tension=.3,e.fill=!0,e.pointRadius=6,e.pointHoverRadius=6,e.pointBackgroundColor="rgba(0, 0, 0, 0)",e.pointBorderColor="rgba(0, 0, 0, 0)",e.pointHoverBackgroundColor=n,e.pointHoverBorderColor=n})),chartInstances[n]){let e=chartInstances[n];e.data.labels=t.labels,e.data.datasets=t.datasets,e.update(),updateYAxisVisibility()}else chartInstances[n]=new Chart(o.getContext("2d"),{type:"line",data:t,options:{interaction:{intersect:!1,mode:"index"},responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,displayColors:!0,callbacks:{labelColor:function(e){const t=e.dataset;return{backgroundColor:t.borderColor,borderColor:t.borderColor,borderWidth:2}}}}},scales:{x:{display:!1}},elements:{line:{tension:.2},point:{radius:0,hoverRadius:6}}}}),updateYAxisVisibility()})))}))}function updateYAxisVisibility(){const e=coloumnSet>2,[,t]=getComputedStyle(document.body).backgroundColor.match(/\d+/g);Object.values(chartInstances).forEach((n=>{n&&(Object.keys(n.options.scales).forEach((o=>{o.startsWith("y-")&&(n.options.scales[o].display=e||!!selectionData[n.canvas.offsetParent?.id.match(/=(\d+),(\d+)/)?.[2]]?.A?.Y,n.options.scales[o].ticks.color="0"===t?"grey":"white"),o.startsWith("y-r")&&(n.options.scales[o].position="right")})),n.update())}))}let l=!0;function checkColumns(){let e=coloumnSet<3;e&&l&&(htmlold="",newFJ()),l=!e}